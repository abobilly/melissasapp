<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Melissa's Adventure: Escape from S≈çl</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            overflow: hidden;
            height: 100vh;
            font-family: Arial, sans-serif;
            background: linear-gradient(135deg, #87CEEB, #98FB98, #87CEFA);
            position: relative;
        }

        /* Background Image Layer */
        .waterfall {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            overflow: hidden;
        }

        .bg-image {
            position: absolute;
            inset: 0;
            background-image: url('outdoors.webp');
            background-size: cover; /* fill while preserving aspect */
            background-position: center center;
            background-repeat: no-repeat;
            transform: translateZ(0); /* promote to its own layer */
            will-change: transform, filter;
            z-index: 1;
            transition: filter 2s ease-in-out;
        }

        /* Removed old water stream/video styles */

        /* Butterfly Styles */
        .butterfly {
            position: absolute;
            width: 60px;
            height: 60px;
            z-index: 10;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .butterfly:hover {
            transform: scale(1.3);
        }

        .wing {
            position: absolute;
            border-radius: 50% 10% 50% 10%;
            animation: flutter 0.5s ease-in-out infinite alternate;
            position: relative;
        }

        .wing::before {
            content: '';
            position: absolute;
            top: 15%;
            left: 20%;
            width: 8px;
            height: 8px;
            background: radial-gradient(circle, rgba(255,255,255,0.8) 0%, rgba(255,255,255,0.3) 50%, transparent 70%);
            border-radius: 50%;
            z-index: 1;
        }

        .wing::after {
            content: '';
            position: absolute;
            top: 40%;
            left: 35%;
            width: 4px;
            height: 4px;
            background: radial-gradient(circle, rgba(255,255,255,0.6) 0%, rgba(255,255,255,0.2) 60%, transparent 80%);
            border-radius: 50%;
            z-index: 1;
        }

        .left-wing {
            left: 0;
            top: 0;
            width: 20px;
            height: 25px;
            transform-origin: bottom right;
            background-image: 
                linear-gradient(45deg, transparent 30%, rgba(255,255,255,0.1) 50%, transparent 70%),
                radial-gradient(ellipse at 30% 60%, rgba(0,0,0,0.1) 0%, transparent 50%);
        }

        .right-wing {
            right: 0;
            top: 0;
            width: 20px;
            height: 25px;
            transform-origin: bottom left;
            animation-delay: 0.1s;
            background-image: 
                linear-gradient(-45deg, transparent 30%, rgba(255,255,255,0.1) 50%, transparent 70%),
                radial-gradient(ellipse at 70% 60%, rgba(0,0,0,0.1) 0%, transparent 50%);
        }

        .body {
            position: absolute;
            left: 50%;
            top: 0;
            width: 4px;
            height: 30px;
            background: linear-gradient(180deg, #654321 0%, #8B4513 30%, #A0522D 60%, #8B4513 100%);
            border-radius: 50px;
            transform: translateX(-50%);
            z-index: 11;
            box-shadow: 0 0 3px rgba(0,0,0,0.3);
        }

        .body::before {
            content: '';
            position: absolute;
            top: 2px;
            left: 50%;
            width: 6px;
            height: 6px;
            background: radial-gradient(circle, #2F1B14 0%, #8B4513 70%);
            border-radius: 50%;
            transform: translateX(-50%);
        }

        .body::after {
            content: '';
            position: absolute;
            top: -2px;
            left: 50%;
            width: 2px;
            height: 8px;
            background: #654321;
            border-radius: 1px;
            transform: translateX(-50%);
        }

        @keyframes flutter {
            0% { transform: rotateY(0deg); }
            100% { transform: rotateY(45deg); }
        }

        /* Different butterfly colors with realistic patterns */
        .butterfly-orange .wing {
            background: 
                radial-gradient(ellipse at 25% 25%, rgba(255,255,255,0.4) 0%, transparent 30%),
                radial-gradient(ellipse at 70% 80%, rgba(139,69,19,0.6) 0%, transparent 40%),
                radial-gradient(circle at 30% 30%, #FFD700, #FF8C00, #FF4500),
                linear-gradient(135deg, rgba(255,140,0,0.8) 0%, rgba(255,69,0,0.9) 100%);
            box-shadow: 0 0 15px rgba(255, 140, 0, 0.6);
        }

        .butterfly-blue .wing {
            background: 
                radial-gradient(ellipse at 25% 25%, rgba(255,255,255,0.5) 0%, transparent 25%),
                radial-gradient(ellipse at 60% 75%, rgba(0,0,139,0.7) 0%, transparent 35%),
                radial-gradient(circle at 30% 30%, #87CEEB, #4169E1, #0000CD),
                linear-gradient(135deg, rgba(65,105,225,0.8) 0%, rgba(0,0,205,0.9) 100%);
            box-shadow: 0 0 15px rgba(65, 105, 225, 0.6);
        }

        .butterfly-pink .wing {
            background: 
                radial-gradient(ellipse at 30% 20%, rgba(255,255,255,0.6) 0%, transparent 25%),
                radial-gradient(ellipse at 50% 80%, rgba(220,20,60,0.5) 0%, transparent 40%),
                radial-gradient(circle at 30% 30%, #FFB6C1, #FF69B4, #DC143C),
                linear-gradient(135deg, rgba(255,105,180,0.8) 0%, rgba(220,20,60,0.9) 100%);
            box-shadow: 0 0 15px rgba(255, 105, 180, 0.6);
        }

        .butterfly-purple .wing {
            background: 
                radial-gradient(ellipse at 25% 30%, rgba(255,255,255,0.4) 0%, transparent 30%),
                radial-gradient(ellipse at 65% 70%, rgba(75,0,130,0.6) 0%, transparent 35%),
                radial-gradient(circle at 30% 30%, #DDA0DD, #9370DB, #8A2BE2),
                linear-gradient(135deg, rgba(147,112,219,0.8) 0%, rgba(138,43,226,0.9) 100%);
            box-shadow: 0 0 15px rgba(147, 112, 219, 0.6);
        }

        .butterfly-green .wing {
            background: 
                radial-gradient(ellipse at 20% 25%, rgba(255,255,255,0.5) 0%, transparent 25%),
                radial-gradient(ellipse at 70% 75%, rgba(34,139,34,0.7) 0%, transparent 40%),
                radial-gradient(circle at 30% 30%, #98FB98, #32CD32, #228B22),
                linear-gradient(135deg, rgba(50,205,50,0.8) 0%, rgba(34,139,34,0.9) 100%);
            box-shadow: 0 0 15px rgba(50, 205, 50, 0.6);
        }

        /* Floating animation */
        @keyframes float {
            0%, 100% { 
                transform: translateY(0px) translateX(0px) rotate(0deg); 
            }
            25% { 
                transform: translateY(-20px) translateX(10px) rotate(5deg); 
            }
            50% { 
                transform: translateY(-10px) translateX(-15px) rotate(-3deg); 
            }
            75% { 
                transform: translateY(-25px) translateX(5px) rotate(2deg); 
            }
        }

        .floating {
            animation: float 6s ease-in-out infinite;
        }

        /* Mist effect */
        .mist {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 200px;
            background: linear-gradient(0deg, 
                rgba(255,255,255,0.4) 0%, 
                rgba(255,255,255,0.1) 50%, 
                transparent 100%);
            z-index: 5;
            animation: mistMove 8s ease-in-out infinite;
        }

        @keyframes mistMove {
            0%, 100% { transform: translateX(0px); opacity: 0.4; }
            50% { transform: translateX(20px); opacity: 0.6; }
        }

        /* Sparkle effects */
        .sparkle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: white;
            border-radius: 50%;
            z-index: 15;
            animation: sparkleAnim 3s ease-in-out infinite;
        }

        @keyframes sparkleAnim {
            0%, 100% { opacity: 0; transform: scale(0); }
            50% { opacity: 1; transform: scale(1); }
        }

        /* Evil mode styles */
        .evil-mode {
            background: linear-gradient(135deg, #8B0000, #DC143C, #B22222) !important;
            transition: background 2s ease-in-out;
        }

        .evil-mode .waterfall { transition: all 2s ease-in-out; }
        .evil-mode .bg-image {
            filter: hue-rotate(0deg) saturate(1.6) contrast(1.25) brightness(0.85) sepia(0.7);
        }

        .evil-mode .mist {
            background: linear-gradient(0deg, 
                rgba(255,0,0,0.4) 0%, 
                rgba(255,69,0,0.2) 50%, 
                transparent 100%) !important;
            animation: evilMistMove 4s ease-in-out infinite;
        }

        @keyframes evilMistMove {
            0%, 100% { transform: translateX(0px) scale(1.1); opacity: 0.6; }
            50% { transform: translateX(-30px) scale(1.2); opacity: 0.8; }
        }

        /* Timer display */
        .timer {
            position: fixed;
            top: 20px;
            left: 20px;
            font-size: 24px;
            font-weight: bold;
            color: white;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
            z-index: 20;
            background: rgba(0,0,0,0.3);
            padding: 10px 20px;
            border-radius: 10px;
            border: 2px solid rgba(255,255,255,0.3);
        }

        .timer.warning {
            color: #FF6B6B;
            animation: timerPulse 0.5s ease-in-out infinite;
        }

        @keyframes timerPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        /* Game over screen - iPhone responsive */
        .game-over {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 100;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: white;
            font-size: clamp(24px, 5vw, 48px);
            text-shadow: 3px 3px 6px rgba(0,0,0,0.9);
            opacity: 0;
            visibility: hidden;
            transition: all 0.5s ease-in-out;
            padding: 20px;
            box-sizing: border-box;
            text-align: center;
            overflow-y: auto;
        }

        .game-over.show {
            opacity: 1;
            visibility: visible;
        }

        .game-over #gameOverText {
            max-width: 90%;
            line-height: 1.2;
            margin-bottom: 20px;
            word-wrap: break-word;
        }

        .game-over button {
            margin-top: 20px;
            padding: 15px 30px;
            font-size: clamp(16px, 4vw, 24px);
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: background 0.3s ease;
            min-width: 150px;
        }

        .game-over button:hover {
            background: #45a049;
        }

        /* iPhone specific fixes */
        @media (max-width: 480px) {
            .game-over {
                font-size: 20px;
                padding: 15px;
            }
            
            .game-over #gameOverText {
                max-width: 95%;
                line-height: 1.3;
            }
            
            .game-over button {
                font-size: 18px;
                padding: 12px 25px;
                margin-top: 15px;
            }
        }

        /* iPhone landscape mode */
        @media (max-height: 500px) and (orientation: landscape) {
            .game-over {
                font-size: 18px;
                padding: 10px;
            }
            
            .game-over #gameOverText {
                margin-bottom: 10px;
            }
            
            .game-over button {
                margin-top: 10px;
                padding: 10px 20px;
            }
        }

        /* Aunt photo styling - transparent PNG, wide movement, slower */
        .aunt-butterfly {
            width: 100px !important;
            height: 100px !important;
            background-image: url('myaunt.png');
            background-size: contain;
            background-position: center;
            background-repeat: no-repeat;
            /* No outline or glow to avoid any square edge appearance */
            outline: none;
            border: none;
            box-shadow: none;
            animation: wideErraticFloat 10s ease-in-out infinite !important;
            z-index: 12 !important;
            /* Prevent tap highlight on mobile (which can look like a square) */
            -webkit-tap-highlight-color: transparent;
        }

        .aunt-butterfly.shaking {
            animation: auntShakeIntense 0.15s ease-in-out infinite !important;
        }

        @keyframes auntShakeIntense {
            0% { transform: translateX(0px) translateY(0px) rotate(0deg); }
            10% { transform: translateX(-8px) translateY(-5px) rotate(-2deg); }
            20% { transform: translateX(8px) translateY(5px) rotate(2deg); }
            30% { transform: translateX(-6px) translateY(8px) rotate(-1deg); }
            40% { transform: translateX(10px) translateY(-3px) rotate(3deg); }
            50% { transform: translateX(-5px) translateY(-8px) rotate(-2deg); }
            60% { transform: translateX(7px) translateY(6px) rotate(1deg); }
            70% { transform: translateX(-9px) translateY(-2px) rotate(-3deg); }
            80% { transform: translateX(6px) translateY(-7px) rotate(2deg); }
            90% { transform: translateX(-4px) translateY(9px) rotate(-1deg); }
            100% { transform: translateX(0px) translateY(0px) rotate(0deg); }
        }

        .aunt-butterfly dotlottie-wc {
            display: none !important;
        }

        @keyframes wideErraticFloat {
            0% { 
                transform: translateY(0px) translateX(0px) rotate(0deg) scale(1); 
            }
            20% { 
                transform: translateY(-40px) translateX(60px) rotate(8deg) scale(1.05); 
            }
            40% { 
                transform: translateY(-20px) translateX(-80px) rotate(-5deg) scale(0.95); 
            }
            60% { 
                transform: translateY(-60px) translateX(70px) rotate(6deg) scale(1.02); 
            }
            80% { 
                transform: translateY(-30px) translateX(-60px) rotate(-4deg) scale(0.98); 
            }
            100% { 
                transform: translateY(0px) translateX(0px) rotate(0deg) scale(1); 
            }
        }

        /* Victory image */
        .victory-image {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 150;
            max-width: 400px;
            max-height: 400px;
            border-radius: 20px;
            box-shadow: 0 0 50px rgba(255, 215, 0, 0.8);
            opacity: 0;
            visibility: hidden;
            transition: all 1s ease-in-out;
            animation: victoryFloat 3s ease-in-out infinite;
        }

        .victory-image.show {
            opacity: 1;
            visibility: visible;
        }

        @keyframes victoryFloat {
            0%, 100% { transform: translate(-50%, -50%) scale(1) rotate(0deg); }
            50% { transform: translate(-50%, -55%) scale(1.05) rotate(2deg); }
        }

        /* Victory celebration effects */
        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            z-index: 140;
            animation: confettiFall 3s ease-in-out infinite;
        }

        @keyframes confettiFall {
            0% { 
                transform: translateY(-100vh) rotate(0deg);
                opacity: 1;
            }
            100% { 
                transform: translateY(100vh) rotate(720deg);
                opacity: 0;
            }
        }

        .confetti-gold { background: #FFD700; }
        .confetti-silver { background: #C0C0C0; }
        .confetti-red { background: #FF6B6B; }
        .confetti-blue { background: #4ECDC4; }
        .confetti-green { background: #45B7D1; }

        /* Cousin styling - using mycousin.png */
        .cousin {
            position: fixed;
            width: 60px;
            height: 60px;
            background-image: url('mycousin.png');
            background-size: contain;
            background-position: center;
            background-repeat: no-repeat;
            z-index: 10;
            cursor: pointer;
            transition: all 0.3s ease;
            animation: cousinFloat 4s ease-in-out infinite;
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            /* No outline or glow to keep it clean */
            outline: none;
            -webkit-tap-highlight-color: transparent;
        }

        .cousin:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 15px rgba(255,255,255,0.4);
        }

        .cousin.shaking {
            animation: cousinShake 0.5s ease-in-out infinite;
        }

        @keyframes cousinShake {
            0%, 100% { transform: translateX(0px); }
            25% { transform: translateX(-2px); }
            75% { transform: translateX(2px); }
        }

        @keyframes cousinFloat {
            0%, 100% { 
                transform: translateY(0px) translateX(0px) rotate(0deg); 
            }
            25% { 
                transform: translateY(-20px) translateX(10px) rotate(5deg); 
            }
            50% { 
                transform: translateY(-10px) translateX(-15px) rotate(-3deg); 
            }
            75% { 
                transform: translateY(-25px) translateX(5px) rotate(2deg); 
            }
        }

        .cousin.transforming {
            animation: cousinToButterflyTransform 1.2s ease-out forwards;
        }

        @keyframes cousinToButterflyTransform {
            0% { 
                transform: scale(1) rotate(0deg);
                background: linear-gradient(135deg, #ff6b9d, #c44569);
            }
            50% { 
                transform: scale(1.5) rotate(180deg);
                background: linear-gradient(135deg, #ffd700, #ff8c00);
                border-radius: 20px;
            }
            100% { 
                transform: scale(0.8) rotate(360deg);
                background: transparent;
                border-radius: 50%;
            }
        }

        /* Gossip and Drama Effects */
        .gossip-bubble {
            position: absolute;
            background: rgba(255, 255, 255, 0.95);
            border: 2px solid #ff69b4;
            border-radius: 20px;
            padding: 5px 10px;
            font-size: 12px;
            font-weight: bold;
            color: #d63384;
            z-index: 100;
            animation: gossipFloat 2s ease-out forwards;
            pointer-events: none;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            font-family: 'Arial', sans-serif;
        }

        /* Special styling for aunt's quotes */
        .gossip-bubble.aunt-quote {
            background: linear-gradient(135deg, #ffd700, #ffb347);
            border: 3px solid #ff6347;
            color: #8b0000;
            font-family: 'Georgia', serif;
            font-size: 14px;
            font-weight: bold;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
            box-shadow: 0 4px 15px rgba(255,99,71,0.4);
            min-width: 120px;
            text-align: center;
        }

        @keyframes gossipFloat {
            0% { 
                opacity: 0;
                transform: scale(0.5) translateY(0px);
            }
            50% { 
                opacity: 1;
                transform: scale(1) translateY(-20px);
            }
            100% { 
                opacity: 0;
                transform: scale(0.8) translateY(-40px);
            }
        }

        .butterfly.staring {
            animation: dramaticStare 1.5s ease-in-out forwards !important;
        }

        @keyframes dramaticStare {
            0% { transform: scale(1) rotate(0deg); }
            50% { transform: scale(1.2) rotate(5deg); }
            100% { transform: scale(1.1) rotate(0deg); }
        }

        .butterfly.gasping {
            animation: gasp 0.8s ease-out forwards;
        }

        @keyframes gasp {
            0% { transform: scale(1); }
            50% { transform: scale(1.3); }
            100% { transform: scale(1.1); }
        }

        .butterfly.table-flip-scatter {
            animation: scatterPanic 2s ease-out forwards !important;
        }

        @keyframes scatterPanic {
            0% { 
                transform: scale(1) rotate(0deg);
            }
            20% { 
                transform: scale(0.8) rotate(-15deg);
            }
            100% { 
                transform: scale(0.9) rotate(0deg);
                left: var(--scatter-x) !important;
                top: var(--scatter-y) !important;
            }
        }
    </style>
</head>
<body>
    <!-- Background Image Layer -->
    <div class="waterfall">
        <div class="bg-image"></div>
    </div>

    <!-- Mist Effect -->
    <div class="mist"></div>

    <!-- Timer Display -->
    <div class="timer" id="timer">Time: 15s</div>

    <!-- Game Over Screen -->
    <div class="game-over" id="gameOver">
        <div id="gameOverText">You didn't click fast enough!</div>
        <button onclick="restartGame()">Try Again</button>
    </div>

    <!-- Victory Image -->
    <img class="victory-image" id="victoryImage" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjQwMCIgdmlld0JveD0iMCAwIDQwMCA0MDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxjaXJjbGUgY3g9IjIwMCIgY3k9IjIwMCIgcj0iMTkwIiBmaWxsPSIjRkZENzAwIiBzdHJva2U9IiNGRkE1MDAiIHN0cm9rZS13aWR0aD0iMTAiLz4KPHN0YXIgY3g9IjIwMCIgY3k9IjIwMCIgcj0iMTIwIiBmaWxsPSIjRkZGRkZGIiBzdHJva2U9IiNGRkE1MDAiIHN0cm9rZS13aWR0aD0iNSIvPgo8dGV4dCB4PSIyMDAiIHk9IjE0MCIgZm9udC1mYW1pbHk9IkFyaWFsLCBzYW5zLXNlcmlmIiBmb250LXNpemU9IjQ4IiBmb250LXdlaWdodD0iYm9sZCIgZmlsbD0iI0ZGQTUwMCIgdGV4dC1hbmNob3I9Im1pZGRsZSI+8J+PhTwvdGV4dD4KPHR5ZXh0IHg9IjIwMCIgeT0iMjEwIiBmb250LWZhbWlseT0iQXJpYWwsIHNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMzYiIGZvbnQtd2VpZ2h0PSJib2xkIiBmaWxsPSIjRkZBNTAwIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIj5WSUNUT1JZITwvdGV4dD4KPHR5ZXh0IHg9IjIwMCIgeT0iMjYwIiBmb250LWZhbWlseT0iQXJpYWwsIHNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMjQiIGZpbGw9IiNGRkE1MDAiIHRleHQtYW5jaG9yPSJtaWRkbGUiPkV2aWwgQnV0dGVyZmx5PC90ZXh0Pgo8dGV4dCB4PSIyMDAiIHk9IjI5MCIgZm9udC1mYW1pbHk9IkFyaWFsLCBzYW5zLXNlcmlmIiBmb250LXNpemU9IjI0IiBmaWxsPSIjRkZBNTAwIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIj5EZWZFQVRFRCE8L3RleHQ+Cjwvc3ZnPgo=" alt="Victory Trophy" />

    <!-- Audio elements for sound effects -->
    <audio id="trumpetSound" preload="auto">
        <source src="data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhBzuZ3/LNeyUFl5vb8sGFTwsOGb/n9rJlFglJk/v1vWwyByKA3vq0hyYMIYHK7dt+OAGUkvv3t2Y0CBGUx+7VgkIFKHnJ7N2ARwMG" type="audio/wav">
    </audio>

    <!-- Butterflies will be generated by JavaScript -->

    <script src="https://unpkg.com/@lottiefiles/dotlottie-wc@0.8.1/dist/dotlottie-wc.js" type="module"></script>
    
    <script>
        const colors = ['orange', 'blue', 'pink', 'purple', 'green'];
        const butterflies = [];
        const cousins = [];
        let evilButterflyIndex = -1;
        let gameTimer = 15;
        let timerInterval = null;
        let isGameActive = true;
        let isEvilMode = false;
        let cousinsTransformed = 0;
        let auntHasEntered = false;
        
        // Aunt quotes
        const auntRegularQuotes = [
            "I am very important to God",
            "If I give you a Chanel necklace and you choke on it, that's your problem, not mine.",
            "Tornado. Spin the truth. Destroy!",
            "I'm on play, all the time.",
            "You want me to be your villain? I'll be your villain.",
            "Middle class people don't have $60,000 rings. YES. THEY DO",
            "I'm in 17C"
        ];
        
        // Cousin quotes
        const cousinRegularQuotes = [
            "I had to fire 30 employees.",
            "The launch is cancelled.",
            "I am more of a free spirit without the Holy Spirit",
            "On my healing journey, I always travel first class",
            "Stop weaponizing my trauma against me",
            "I would never assume that Meredith has a dirty house",
            "This rose isn't scared to handle a little prick",
            "There's more bathtub fights coming"
        ];
        
        let auntQuoteInterval = null;
        let cousinQuoteIntervals = [];

        function createCousin() {
            const cousin = document.createElement('div');
            cousin.className = 'cousin';
            
            // Random starting position
            cousin.style.left = Math.random() * (window.innerWidth - 60) + 'px';
            cousin.style.top = Math.random() * (window.innerHeight - 60) + 'px';
            
            // Random animation duration and delay
            cousin.style.animationDuration = (3 + Math.random() * 2) + 's';
            cousin.style.animationDelay = Math.random() * 1 + 's';
            
            document.body.appendChild(cousin);
            cousins.push(cousin);

            // Special entrance quote
            setTimeout(() => {
                showGossipBubble(cousin, "Have you heard of s≈çl?");
            }, 500);

            // Add click interaction - transform cousin to butterfly
            cousin.addEventListener('click', function() {
                if (!isGameActive || cousin.classList.contains('transforming')) return;
                
                transformCousinToButterfly(cousin);
            });

            // Add hover interaction - also transform cousin to butterfly
            cousin.addEventListener('mouseenter', function() {
                if (!isGameActive || cousin.classList.contains('transforming')) return;
                
                transformCousinToButterfly(cousin);
            });

            // Start random quote cycle for this cousin
            startCousinQuoteCycle(cousin);

            return cousin;
        }

        function createButterfly() {
            const butterfly = document.createElement('div');
            butterfly.className = `butterfly floating`;
            
            // Random starting position
            butterfly.style.left = Math.random() * (window.innerWidth - 80) + 'px';
            butterfly.style.top = Math.random() * (window.innerHeight - 80) + 'px';
            
            // Random animation duration and delay
            butterfly.style.animationDuration = (4 + Math.random() * 4) + 's';
            butterfly.style.animationDelay = Math.random() * 2 + 's';

            // Create Lottie butterfly
            const lottieButterfly = document.createElement('dotlottie-wc');
            lottieButterfly.setAttribute('src', 'https://lottie.host/ff8b8e58-bc7d-4e1d-a883-a4c8c028d9da/2nMrBFofQd.lottie');
            lottieButterfly.setAttribute('autoplay', '');
            lottieButterfly.setAttribute('loop', '');
            lottieButterfly.style.width = '60px';
            lottieButterfly.style.height = '60px';
            lottieButterfly.style.pointerEvents = 'none';
            
            // Random color filter for variety
            const colorFilters = [
                'hue-rotate(0deg)', // original
                'hue-rotate(60deg)', // different color
                'hue-rotate(120deg)', // another color
                'hue-rotate(180deg)', // opposite color
                'hue-rotate(240deg)', // another variation
                'hue-rotate(300deg)' // final variation
            ];
            lottieButterfly.style.filter = colorFilters[Math.floor(Math.random() * colorFilters.length)];
            
            butterfly.appendChild(lottieButterfly);
            document.body.appendChild(butterfly);
            butterflies.push(butterfly);

            // Add click interaction only for aunt
            butterfly.addEventListener('click', function() {
                if (!isGameActive) return;
                
                const butterflyIndex = butterflies.indexOf(butterfly);
                
                if (butterflyIndex === evilButterflyIndex) {
                    // Clicked your aunt! But now this doesn't end the game immediately
                    // Just show aunt reaction
                    showGossipBubble(butterfly, "I'm the queen bee! üëë");
                    createSparkles(butterfly);
                }
            });

            return butterfly;
        }

        function createSparkles(butterfly) {
            for (let i = 0; i < 6; i++) {
                const sparkle = document.createElement('div');
                sparkle.className = 'sparkle';
                
                const rect = butterfly.getBoundingClientRect();
                sparkle.style.left = (rect.left + Math.random() * 40 - 10) + 'px';
                sparkle.style.top = (rect.top + Math.random() * 30 - 10) + 'px';
                sparkle.style.animationDelay = (i * 0.1) + 's';
                
                document.body.appendChild(sparkle);
                
                setTimeout(() => {
                    sparkle.remove();
                }, 3000);
            }
        }

        function createExplosionAnimation(x, y) {
            const explosion = document.createElement('div');
            explosion.style.position = 'absolute';
            explosion.style.left = (x - 50) + 'px'; // Center the explosion
            explosion.style.top = (y - 50) + 'px';
            explosion.style.width = '100px';
            explosion.style.height = '100px';
            explosion.style.zIndex = '20';
            explosion.style.pointerEvents = 'none';
            
            const img = document.createElement('img');
            img.style.width = '100%';
            img.style.height = '100%';
            
            document.body.appendChild(explosion);
            explosion.appendChild(img);
            
            let frame = 0;
            const maxFrames = 9; // explosion00.png through explosion08.png
            
            const animateExplosion = () => {
                if (frame < maxFrames) {
                    img.src = `Explosion/explosion0${frame}.png`;
                    frame++;
                    setTimeout(animateExplosion, 80); // Change frame every 80ms
                } else {
                    explosion.remove(); // Remove explosion when done
                }
            };
            
            animateExplosion();
        }

        function moveButterfly(butterfly) {
            const isAunt = butterfly.classList.contains('aunt-butterfly');
            const maxX = window.innerWidth - (isAunt ? 100 : 60);
            const maxY = window.innerHeight - (isAunt ? 100 : 60);
            
            if (isAunt) {
                // Keep aunt in the middle third of the screen
                const centerX = window.innerWidth / 2;
                const centerY = window.innerHeight / 2;
                const rangeX = window.innerWidth / 6; // ¬±1/6 of screen width from center
                const rangeY = window.innerHeight / 6; // ¬±1/6 of screen height from center
                
                const newX = Math.max(50, Math.min(maxX, centerX - rangeX + Math.random() * (rangeX * 2)));
                const newY = Math.max(50, Math.min(maxY, centerY - rangeY + Math.random() * (rangeY * 2)));
                
                butterfly.style.transition = 'all 3s ease-in-out';
                butterfly.style.left = newX + 'px';
                butterfly.style.top = newY + 'px';
            } else {
                // Regular butterflies can move anywhere
                const newX = Math.random() * maxX;
                const newY = Math.random() * maxY;
                
                butterfly.style.transition = 'all 3s ease-in-out';
                butterfly.style.left = newX + 'px';
                butterfly.style.top = newY + 'px';
            }
        }

        // Counter for less frequent non-aunt animations
        let animationCounter = 0;
        let auntIsSpeaking = false;

        function animateButterflies() {
            animationCounter++;
            
            // Get aunt position for attraction/repulsion
            const aunt = butterflies.find(b => b.classList.contains('aunt-butterfly'));
            let auntRect = null;
            if (aunt) {
                auntRect = aunt.getBoundingClientRect();
            }
            
            butterflies.forEach(butterfly => {
                const isAunt = butterfly.classList.contains('aunt-butterfly');
                if (isAunt) {
                    // Aunt moves normally but stops/hovers when speaking
                    if (!auntIsSpeaking && animationCounter % 80 === 0 && Math.random() < 0.3) {
                        moveButterfly(butterfly);
                    }
                } else if (animationCounter % 20 === 0) { // Check attraction every second
                    // Regular butterflies are attracted to aunt
                    if (auntRect) {
                        const butterflyRect = butterfly.getBoundingClientRect();
                        const distance = Math.sqrt(
                            Math.pow(auntRect.left - butterflyRect.left, 2) + 
                            Math.pow(auntRect.top - butterflyRect.top, 2)
                        );
                        
                        if (distance < 200 && distance > 50) {
                            // Move butterfly closer to aunt
                            const targetX = auntRect.left - 30 + Math.random() * 60;
                            const targetY = auntRect.top - 30 + Math.random() * 60;
                            
                            butterfly.style.transition = 'all 2s ease-in-out';
                            butterfly.style.left = Math.max(0, Math.min(window.innerWidth - 60, targetX)) + 'px';
                            butterfly.style.top = Math.max(0, Math.min(window.innerHeight - 60, targetY)) + 'px';
                        }
                    }
                    
                    if (animationCounter % 80 === 0 && Math.random() < 0.3) { // Also normal movement chance
                        moveButterfly(butterfly);
                    }
                }
            });
            
            // Handle cousin repulsion and movement
            if (animationCounter % 20 === 0) { // Check repulsion every second
                cousins.forEach(cousin => {
                    if (auntRect) {
                        const cousinRect = cousin.getBoundingClientRect();
                        const distance = Math.sqrt(
                            Math.pow(auntRect.left - cousinRect.left, 2) + 
                            Math.pow(auntRect.top - cousinRect.top, 2)
                        );
                        
                        if (distance < 150) {
                            // Repel cousin away from aunt
                            const repelX = cousinRect.left + (cousinRect.left - auntRect.left) * 0.5;
                            const repelY = cousinRect.top + (cousinRect.top - auntRect.top) * 0.5;
                            
                            cousin.style.transition = 'all 1.5s ease-out';
                            cousin.style.left = Math.max(0, Math.min(window.innerWidth - 60, repelX)) + 'px';
                            cousin.style.top = Math.max(0, Math.min(window.innerHeight - 60, repelY)) + 'px';
                        }
                    }
                    
                    if (animationCounter % 80 === 0 && Math.random() < 0.4) { // Normal movement
                        moveCousin(cousin);
                    }
                });
            }
        }

        function moveCousin(cousin) {
            const maxX = window.innerWidth - 60;
            const maxY = window.innerHeight - 60;
            
            const newX = Math.random() * maxX;
            const newY = Math.random() * maxY;
            
            cousin.style.left = newX + 'px';
            cousin.style.top = newY + 'px';
        }

        function resetTimer() {
            // Timer removed - no time limit anymore
        }

        function updateTimerDisplay() {
            // Show cousin count instead of timer
            const timerElement = document.getElementById('timer');
            timerElement.textContent = `Cousins remaining: ${cousins.length}`;
            timerElement.classList.remove('warning'); // No warnings needed
        }

        function startTimer() {
            // No timer - game continues until all cousins are transformed
            updateTimerDisplay();
        }

        function gameOver() {
            // Game over no longer needed - game ends when all cousins transformed
        }

        function activateEvilMode() {
            isGameActive = false;
            isEvilMode = true;
            clearInterval(timerInterval);
            
            // Hide timer
            document.getElementById('timer').style.display = 'none';
            
            // Play trumpet sound
            playTrumpetSound();
            
            // TABLE FLIP MODE! Scatter all butterflies dramatically
            tableFlipScatter();
            
            // Create confetti effect
            createConfetti();
            
            // Show victory image immediately
            setTimeout(() => {
                document.getElementById('victoryImage').classList.add('show');
            }, 500);
            
            // Transform the scene
            document.body.classList.add('evil-mode');
            
            // Show dramatic victory message
            setTimeout(() => {
                const gameOverScreen = document.getElementById('gameOver');
                const gameOverText = document.getElementById('gameOverText');
                
                gameOverText.innerHTML = "CONGRATULATIONS!<br/>Your AUNT has DISMISSED all cousins!<br/>They've all been transformed!<br/>ULTIMATE FAMILY DRAMA!";
                gameOverScreen.classList.add('show');
            }, 3000);
        }

        function playTrumpetSound() {
            // Create multiple trumpet notes for a fanfare effect
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            
            // Trumpet fanfare notes (approximate frequencies)
            const notes = [261.63, 329.63, 392.00, 523.25, 659.25, 783.99]; // C, E, G, C, E, G
            
            notes.forEach((frequency, index) => {
                setTimeout(() => {
                    const oscillator = audioContext.createOscillator();
                    const gainNode = audioContext.createGain();
                    
                    oscillator.connect(gainNode);
                    gainNode.connect(audioContext.destination);
                    
                    oscillator.frequency.setValueAtTime(frequency, audioContext.currentTime);
                    oscillator.type = 'square'; // Trumpet-like sound
                    
                    gainNode.gain.setValueAtTime(0, audioContext.currentTime);
                    gainNode.gain.linearRampToValueAtTime(0.3, audioContext.currentTime + 0.05);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
                    
                    oscillator.start(audioContext.currentTime);
                    oscillator.stop(audioContext.currentTime + 0.5);
                }, index * 150);
            });
            
            // Final triumphant chord
            setTimeout(() => {
                [261.63, 329.63, 392.00, 523.25].forEach((frequency, index) => {
                    const oscillator = audioContext.createOscillator();
                    const gainNode = audioContext.createGain();
                    
                    oscillator.connect(gainNode);
                    gainNode.connect(audioContext.destination);
                    
                    oscillator.frequency.setValueAtTime(frequency, audioContext.currentTime);
                    oscillator.type = 'square';
                    
                    gainNode.gain.setValueAtTime(0, audioContext.currentTime);
                    gainNode.gain.linearRampToValueAtTime(0.2, audioContext.currentTime + 0.1);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 1.5);
                    
                    oscillator.start(audioContext.currentTime);
                    oscillator.stop(audioContext.currentTime + 1.5);
                });
            }, 1000);
        }

        function createConfetti() {
            const colors = ['gold', 'silver', 'red', 'blue', 'green'];
            
            for (let i = 0; i < 50; i++) {
                setTimeout(() => {
                    const confetti = document.createElement('div');
                    confetti.className = `confetti confetti-${colors[Math.floor(Math.random() * colors.length)]}`;
                    confetti.style.left = Math.random() * 100 + '%';
                    confetti.style.animationDuration = (2 + Math.random() * 3) + 's';
                    confetti.style.animationDelay = Math.random() * 2 + 's';
                    
                    document.body.appendChild(confetti);
                    
                    setTimeout(() => {
                        if (confetti.parentNode) {
                            confetti.parentNode.removeChild(confetti);
                        }
                    }, 5000);
                }, i * 50);
            }
        }

        function restartGame() {
            // Reset all game state
            isGameActive = true;
            isEvilMode = false;
            gameTimer = 15;
            evilButterflyIndex = -1;
            cousinsTransformed = 0;
            auntHasEntered = false;
            
            // Clear quote intervals
            if (auntQuoteInterval) clearInterval(auntQuoteInterval);
            cousinQuoteIntervals.forEach(interval => clearInterval(interval));
            cousinQuoteIntervals = [];
            
            // Clear all butterflies
            butterflies.forEach(butterfly => {
                if (butterfly.parentNode) {
                    butterfly.parentNode.removeChild(butterfly);
                }
            });
            butterflies.length = 0;
            
            // Clear all cousins
            cousins.forEach(cousin => {
                if (cousin.parentNode) {
                    cousin.parentNode.removeChild(cousin);
                }
            });
            cousins.length = 0;
            
            // Clear confetti
            const confettiElements = document.querySelectorAll('.confetti');
            confettiElements.forEach(confetti => {
                if (confetti.parentNode) {
                    confetti.parentNode.removeChild(confetti);
                }
            });
            
            // Clear gossip bubbles
            const gossipElements = document.querySelectorAll('.gossip-bubble');
            gossipElements.forEach(bubble => {
                if (bubble.parentNode) {
                    bubble.parentNode.removeChild(bubble);
                }
            });
            
            // Reset visual state
            document.body.classList.remove('evil-mode');
            document.getElementById('timer').style.display = 'block';
            document.getElementById('gameOver').classList.remove('show');
            document.getElementById('victoryImage').classList.remove('show');
            
            // Restart the game
            initializeGame();
        }

        // Gossip Chain Functions
        function isNearAunt(butterfly) {
            if (evilButterflyIndex === -1) return false;
            
            const aunt = butterflies[evilButterflyIndex];
            if (!aunt) return false;
            
            const butterflyRect = butterfly.getBoundingClientRect();
            const auntRect = aunt.getBoundingClientRect();
            
            const distance = Math.sqrt(
                Math.pow(butterflyRect.left - auntRect.left, 2) + 
                Math.pow(butterflyRect.top - auntRect.top, 2)
            );
            
            return distance < 200; // Within 200px is "near"
        }

        function startGossipChain(initiatorButterfly) {
            // Show gossip bubble
            showGossipBubble(initiatorButterfly, "OMG did you hear?!");
            
            // Play gossip sound
            playGossipSound();
            
            // Make all butterflies turn and stare at aunt
            setTimeout(() => {
                butterflies.forEach((butterfly, index) => {
                    if (butterfly !== initiatorButterfly && index !== evilButterflyIndex) {
                        butterfly.classList.add('staring');
                        
                        // Add gasp effect with slight delay
                        setTimeout(() => {
                            butterfly.classList.add('gasping');
                            if (Math.random() < 0.3) {
                                showGossipBubble(butterfly, "*GASP*");
                            }
                        }, Math.random() * 500);
                    }
                });
                
                // Aunt reacts
                if (evilButterflyIndex !== -1) {
                    const aunt = butterflies[evilButterflyIndex];
                    showGossipBubble(aunt, "I'm just being authentic!");
                }
            }, 800);
            
            // Clear effects after drama plays out
            setTimeout(() => {
                butterflies.forEach(butterfly => {
                    butterfly.classList.remove('staring', 'gasping');
                });
            }, 3000);
        }

        function showGossipBubble(butterfly, text) {
            const bubble = document.createElement('div');
            bubble.className = 'gossip-bubble';
            
            // Check if this is the aunt speaking
            const isAunt = butterfly.classList && butterfly.classList.contains('aunt-butterfly');
            const isCousin = butterfly.classList && butterfly.classList.contains('cousin-butterfly');
            if (isAunt) {
                bubble.classList.add('aunt-quote');
                auntIsSpeaking = true; // Set speaking state
            }
            
            bubble.textContent = text;
            
            const rect = butterfly.getBoundingClientRect();
            // Position bubble at the center-top of the character (their "head")
            const characterCenterX = rect.left + rect.width / 2;
            const characterTopY = rect.top;
            
            // Offset bubble to be above and slightly left of center for better readability
            let bubbleX = characterCenterX - 50; // Center bubble on character, offset left a bit
            let bubbleY = characterTopY - 40; // Place above the character's head
            
            // For aunt (larger image), adjust positioning
            if (isAunt) {
                bubbleY = characterTopY - 50; // More space above aunt
            }
            
            // Check for collision with existing bubbles and remove overlapping ones
            const existingBubbles = document.querySelectorAll('.gossip-bubble');
            existingBubbles.forEach(existingBubble => {
                const existingRect = existingBubble.getBoundingClientRect();
                const existingCenterX = existingRect.left + existingRect.width / 2;
                const existingCenterY = existingRect.top + existingRect.height / 2;
                const newCenterX = bubbleX + 100; // Approximate bubble width center
                const newCenterY = bubbleY + 30; // Approximate bubble height center
                
                const distance = Math.sqrt(
                    Math.pow(newCenterX - existingCenterX, 2) + 
                    Math.pow(newCenterY - existingCenterY, 2)
                );
                
                // If bubbles would overlap (within 120px), remove the existing one
                if (distance < 120 && existingBubble.parentNode) {
                    // Check if we're removing an aunt bubble
                    if (existingBubble.classList.contains('aunt-quote')) {
                        auntIsSpeaking = false;
                    }
                    existingBubble.parentNode.removeChild(existingBubble);
                }
            });
            
            bubble.style.left = bubbleX + 'px';
            bubble.style.top = bubbleY + 'px';
            
            document.body.appendChild(bubble);
            
            setTimeout(() => {
                if (bubble.parentNode) {
                    bubble.parentNode.removeChild(bubble);
                    if (isAunt) {
                        auntIsSpeaking = false; // Clear speaking state when aunt's bubble disappears
                    }
                }
            }, isAunt ? 3000 : 2000); // Aunt's quotes stay longer
        }

        function playGossipSound() {
            // Create a "whisper" sound effect
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator.frequency.setValueAtTime(150, audioContext.currentTime);
            oscillator.frequency.exponentialRampToValueAtTime(300, audioContext.currentTime + 0.3);
            oscillator.type = 'sine';
            
            gainNode.gain.setValueAtTime(0, audioContext.currentTime);
            gainNode.gain.linearRampToValueAtTime(0.1, audioContext.currentTime + 0.05);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3);
            
            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + 0.3);
        }

        function transformCousinToButterfly(cousin) {
            cousin.classList.add('transforming');
            cousinsTransformed++;
            
            // Aunt says "you're dismissed" only 1/6 of the time
            if (evilButterflyIndex !== -1 && Math.random() < 1/6) {
                const aunt = butterflies[evilButterflyIndex];
                if (aunt) {
                    showGossipBubble(aunt, "You're dismissed");
                }
            }
            
            // Stop quote cycle for this cousin
            stopCousinQuoteCycle(cousin);
            
            // Show explosion animation immediately
            const rect = cousin.getBoundingClientRect();
            createExplosionAnimation(rect.left + rect.width/2, rect.top + rect.height/2);
            
            // Transform animation
            setTimeout(() => {
                // Remove cousin and create butterfly in same position
                
                if (cousin.parentNode) {
                    cousin.parentNode.removeChild(cousin);
                }
                
                // Remove from cousins array
                const cousinIndex = cousins.indexOf(cousin);
                if (cousinIndex > -1) {
                    cousins.splice(cousinIndex, 1);
                }
                
                // Create butterfly at same position
                const butterfly = createButterfly();
                butterfly.style.left = rect.left + 'px';
                butterfly.style.top = rect.top + 'px';
                
                // Check if all cousins are transformed
                if (cousins.length === 0) {
                    setTimeout(() => {
                        activateEvilMode();
                    }, 1000);
                }
            }, 1200);
        }

        function transformButterflyToCousin(butterfly) {
            // Create cousin at butterfly position
            const rect = butterfly.getBoundingClientRect();
            const newCousin = createCousin();
            newCousin.style.left = rect.left + 'px';
            newCousin.style.top = rect.top + 'px';
            
            // Special quote when butterfly becomes cousin
            setTimeout(() => {
                showGossipBubble(newCousin, "Have you heard of s≈çl?");
            }, 300);
            
            // Remove butterfly
            if (butterfly.parentNode) {
                butterfly.parentNode.removeChild(butterfly);
            }
            
            const butterflyIndex = butterflies.indexOf(butterfly);
            if (butterflyIndex > -1) {
                // If this was the aunt, we need to reassign
                if (butterflyIndex === evilButterflyIndex) {
                    evilButterflyIndex = -1;
                    setTimeout(() => {
                        selectEvilButterfly();
                    }, 500);
                }
                butterflies.splice(butterflyIndex, 1);
            }
            
            updateTimerDisplay();
        }

        function startCousinQuoteCycle(cousin) {
            const interval = setInterval(() => {
                if (!cousin.parentNode || cousin.classList.contains('transforming')) {
                    clearInterval(interval);
                    return;
                }
                
                if (Math.random() < 0.7) { // 70% chance every cycle (more frequent)
                    // Favor MLM/s≈çl quotes more heavily
                    const mlmQuotes = ["Have you heard of s≈çl?", "Join my MLM!", "This opportunity won't last forever!", "You could be your own boss!"];
                    const allQuotes = [...mlmQuotes, ...mlmQuotes, ...cousinRegularQuotes]; // Double MLM quotes for higher probability
                    const randomQuote = allQuotes[Math.floor(Math.random() * allQuotes.length)];
                    showGossipBubble(cousin, randomQuote);
                }
            }, 4000 + Math.random() * 2000); // Every 4-6 seconds (much more frequent)
            
            cousinQuoteIntervals.push(interval);
        }

        function stopCousinQuoteCycle(cousin) {
            // Clear intervals - not perfect but good enough for this use case
            cousinQuoteIntervals.forEach(interval => clearInterval(interval));
        }

        function startAuntQuoteCycle() {
            if (auntQuoteInterval) clearInterval(auntQuoteInterval);
            
            auntQuoteInterval = setInterval(() => {
                if (evilButterflyIndex === -1 || !isGameActive) return;
                
                const aunt = butterflies[evilButterflyIndex];
                if (!aunt || !aunt.parentNode) return;
                
                if (Math.random() < 0.4) { // 40% chance every cycle
                    const randomQuote = auntRegularQuotes[Math.floor(Math.random() * auntRegularQuotes.length)];
                    showGossipBubble(aunt, randomQuote);
                }
                
                // Random shaking
                if (Math.random() < 0.2) { // 20% chance to shake
                    aunt.classList.add('shaking');
                    // Show the bubble immediately when shaking starts
                    setTimeout(() => {
                        showGossipBubble(aunt, "I'm shaking. I'm physically shaking.");
                    }, 50); // Show almost immediately with shaking
                    
                    setTimeout(() => {
                        aunt.classList.remove('shaking');
                    }, 8000); // Shake for 8 seconds when she says the shaking line!
                }
            }, 3000 + Math.random() * 2000); // Every 3-5 seconds
        }

        function checkCollisions() {
            if (evilButterflyIndex === -1) return;
            
            const aunt = butterflies[evilButterflyIndex];
            if (!aunt) return;
            
            const auntRect = aunt.getBoundingClientRect();
            
            // Check aunt touching butterflies
            butterflies.forEach((butterfly, index) => {
                if (index === evilButterflyIndex) return; // Skip aunt herself
                
                const butterflyRect = butterfly.getBoundingClientRect();
                const distance = Math.sqrt(
                    Math.pow(auntRect.left - butterflyRect.left, 2) + 
                    Math.pow(auntRect.top - butterflyRect.top, 2)
                );
                
                if (distance < 80) { // Within 80px is touching
                    transformButterflyToCousin(butterfly);
                }
            });
            
            // Check cousins touching butterflies for MLM recruitment
            cousins.forEach(cousin => {
                const cousinRect = cousin.getBoundingClientRect();
                
                butterflies.forEach((butterfly, index) => {
                    if (index === evilButterflyIndex) return; // Skip aunt
                    
                    const butterflyRect = butterfly.getBoundingClientRect();
                    const distance = Math.sqrt(
                        Math.pow(cousinRect.left - butterflyRect.left, 2) + 
                        Math.pow(cousinRect.top - butterflyRect.top, 2)
                    );
                    
                    if (distance < 70) { // Within 70px
                        showGossipBubble(cousin, "Join my MLM!");
                        setTimeout(() => {
                            transformButterflyToCousin(butterfly);
                        }, 800);
                    }
                });
            });
        }

        function tableFlipScatter() {
            // Make all butterflies scatter to the edges in panic!
            butterflies.forEach((butterfly, index) => {
                if (index !== evilButterflyIndex) {
                    // Calculate scatter position (edges of screen)
                    const side = Math.floor(Math.random() * 4); // 0=top, 1=right, 2=bottom, 3=left
                    let scatterX, scatterY;
                    
                    switch(side) {
                        case 0: // top
                            scatterX = Math.random() * window.innerWidth;
                            scatterY = 0;
                            break;
                        case 1: // right
                            scatterX = window.innerWidth - 60;
                            scatterY = Math.random() * window.innerHeight;
                            break;
                        case 2: // bottom
                            scatterX = Math.random() * window.innerWidth;
                            scatterY = window.innerHeight - 60;
                            break;
                        case 3: // left
                            scatterX = 0;
                            scatterY = Math.random() * window.innerHeight;
                            break;
                    }
                    
                    // Set CSS custom properties for animation
                    butterfly.style.setProperty('--scatter-x', scatterX + 'px');
                    butterfly.style.setProperty('--scatter-y', scatterY + 'px');
                    
                    // Add panic animation with delay
                    setTimeout(() => {
                        butterfly.classList.add('table-flip-scatter');
                        
                        // Remove after animation completes
                        setTimeout(() => {
                            if (butterfly.parentNode) {
                                butterfly.style.transition = 'opacity 0.5s ease-out';
                                butterfly.style.opacity = '0';
                                setTimeout(() => {
                                    if (butterfly.parentNode) {
                                        butterfly.parentNode.removeChild(butterfly);
                                    }
                                }, 500);
                            }
                        }, 2000);
                    }, index * 50);
                }
            });
        }

        function selectEvilButterfly() {
            if (butterflies.length > 0) {
                evilButterflyIndex = Math.floor(Math.random() * butterflies.length);
                const evilButterfly = butterflies[evilButterflyIndex];
                evilButterfly.classList.add('aunt-butterfly');
                
                // Make aunt move much slower now
                evilButterfly.style.animationDuration = '10s';
                
                // Move aunt to center immediately
                const centerX = (window.innerWidth - 100) / 2;
                const centerY = (window.innerHeight - 100) / 2;
                evilButterfly.style.left = centerX + 'px';
                evilButterfly.style.top = centerY + 'px';
                
                // Aunt entrance quote (only first time)
                if (!auntHasEntered) {
                    auntHasEntered = true;
                    setTimeout(() => {
                        showGossipBubble(evilButterfly, "Hi, Baby Gorgeous!");
                    }, 1000);
                    
                    // Start aunt quote cycle
                    setTimeout(() => {
                        startAuntQuoteCycle();
                    }, 2000);
                }
            }
        }

        function initializeGame() {
            // Create initial cousins (back to 8)
            for (let i = 0; i < 8; i++) {
                setTimeout(() => {
                    createCousin();
                }, i * 200);
            }
            
            // Create the aunt butterfly
            setTimeout(() => {
                createButterfly();
                selectEvilButterfly();
                startTimer(); // This now just updates the cousin counter
            }, 2000);
        }

        // Start the game
        initializeGame();

        // Periodically move butterflies
        setInterval(animateButterflies, 100); // Reasonable frequency for attraction/repulsion

        // Check for collisions regularly
        setInterval(checkCollisions, 500);

        // No automatic butterfly spawning - only cousins transform to butterflies

        // Handle window resize
        window.addEventListener('resize', () => {
            butterflies.forEach(butterfly => {
                const maxX = window.innerWidth - 40;
                const maxY = window.innerHeight - 30;
                
                if (parseInt(butterfly.style.left) > maxX) {
                    butterfly.style.left = maxX + 'px';
                }
                if (parseInt(butterfly.style.top) > maxY) {
                    butterfly.style.top = maxY + 'px';
                }
            });
            
            cousins.forEach(cousin => {
                const maxX = window.innerWidth - 60;
                const maxY = window.innerHeight - 60;
                
                if (parseInt(cousin.style.left) > maxX) {
                    cousin.style.left = maxX + 'px';
                }
                if (parseInt(cousin.style.top) > maxY) {
                    cousin.style.top = maxY + 'px';
                }
            });
        });

        // Add some ambient sparkles (only in normal mode)
        setInterval(() => {
            if (isGameActive && !isEvilMode) {
                const sparkle = document.createElement('div');
                sparkle.className = 'sparkle';
                sparkle.style.left = Math.random() * window.innerWidth + 'px';
                sparkle.style.top = Math.random() * window.innerHeight + 'px';
                sparkle.style.animationDelay = '0s';
                
                document.body.appendChild(sparkle);
                
                setTimeout(() => {
                    sparkle.remove();
                }, 3000);
            }
        }, 2000);
    </script>
</body>
</html>